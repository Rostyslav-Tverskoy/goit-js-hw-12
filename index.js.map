{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"49673705-a6e36a8adce307eb03930fb9e\";\nexport async function getImagesByQuery(query, page = 1) {\n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 15,\n        page,\n    };\n    const response = await axios.get(BASE_URL, { params });\n    \n    return response;\n}\n\n\n","import SimpleLightbox from 'simplelightbox'; \nimport 'simplelightbox/dist/simple-lightbox.min.css'; \nconst loadMore = document.querySelector(\".load-more\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\n\nconst lightbox = new SimpleLightbox(\".gallery a\");\n\nexport function createGallery(images) {\n    const markup = images.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `<li class=\"gallery-item\">\n    <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\"  width=\"360\" height=\"200\" alt=\"${tags}\" />\n    </a>\n    <ul class=\"info\">\n    <li class=\"litext\">\n    <p class=\"ptext\">Likes</p>\n    <p class=\"plink\">${likes}</p>\n    </li>\n    <li class=\"litext\">\n    <p class=\"ptext\">Views</p>\n    <p class=\"plink\">${views}</p>\n    </li>\n    <li class=\"litext\">\n    <p class=\"ptext\">Comments</p>\n    <p class=\"plink\">${comments}</p>\n    </li>\n    <li class=\"litext\">\n    <p class=\"ptext\">Downloads</p>\n    <p class=\"plink\">${downloads}</p>\n    </ul>\n    </li>`).join(\"\");\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    lightbox.refresh();\n\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = \"\";\n}\n    \n\nexport function showLoader() {\n    loader.classList.remove(\"hidden\");\n}\n\nexport function hideLoader() {\n    loader.classList.add(\"hidden\");\n}\n\nexport function showLoadMoreButton() {\n    loadMore.classList.remove(\"hidden\");\n}\n\nexport function hideLoadMoreButton() {\n    loadMore.classList.add(\"hidden\");\n}\n\nlet page = \"lalala\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, hideLoader, showLoader } from \"./js/render-functions\";\nimport { hideLoadMoreButton } from \"./js/render-functions\";\nimport { showLoadMoreButton } from \"./js/render-functions\";\n\n\nconst loadMore = document.querySelector(\".load-more\");\nloadMore.addEventListener(\"click\", handleLoadMore);\nconst form = document.querySelector(\".form\");\nform.addEventListener(\"submit\", handleSubmit);\nlet currentImages = \"\";\nlet currentQuery = \"\";\nlet page = 1;\n async function handleSubmit(event) {\n    event.preventDefault();\n    page = 30;\n    const query = event.target.elements[\"search-text\"].value.trim();\n    if (query === \"\") {\n        iziToast.warning({\n            message: \"Please enter a search query!\",\n            position: \"topRight\",\n          });\n          return;\n    }\n    currentQuery = query;\n    showLoader();\n    clearGallery();\n    hideLoadMoreButton();\n\n\n    await getImagesByQuery(query, page).then((response) => {\n        if (response.data.hits.length === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                position: \"topRight\",\n            })\n            return;\n        }\n        \n        createGallery(response.data.hits);\n        \n        const totalImages = Math.ceil(response.data.totalHits / 15);\n        \n        currentImages = totalImages;\n        if(page < totalImages) {\n            showLoadMoreButton();\n            return;  \n        }\n        hideLoadMoreButton();\n        \n    }\n        )\n        .catch((error) => iziToast.error({\n            message:\"Что то пошло не так\",\n            position: \"topRight\"\n        }))\n        .finally(() => hideLoader())   \n}\n\n\n\n\nasync function handleLoadMore() {\n    page++\n    loadMore.disabled = true;\n    loadMore.classList.replace(\"load-more\", \"loader\");\n    try {\n      const data = await getImagesByQuery(currentQuery, page);\n        createGallery(data.data.hits);\n        loadMore.classList.replace(\"loader\", \"load-more\");\n      loadMore.disabled = false;\n      if(page < currentImages){\n        showLoadMoreButton();\n        const galleryItem = document.querySelector(\".gallery-item\");\n        const cardHeight = galleryItem.getBoundingClientRect().height;\n\n        window.scrollBy ({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        })\n        return;  \n      } \n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: \"topRight\"\n      })  \n    }\n    catch(error) {\n        iziToast.error({\n            message:\"Что то пошло не так\",\n            position: \"topRight\"\n        })\n    }\n    \n}\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","params","axios","loadMore","gallery","loader","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","handleLoadMore","form","handleSubmit","currentImages","currentQuery","event","iziToast","response","totalImages","error","data","cardHeight"],"mappings":"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"}